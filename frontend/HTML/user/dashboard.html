<!DOCTYPE html>
<html>
  <head>
    <title>User Dashboard</title>
    <link rel="stylesheet" href="/css/style.css" />
  </head>
  <body>
    <header class="navbar">
      <div class="nav-left">
        <span class="app-name">Mini App</span>
      </div>
      <span class="user-info">
        ðŸ‘¤ <span id="nav-username"></span> (<span id="nav-role"></span>)
      </span>
      <div class="nav-right">
        <button onclick="window.Auth.logout()" class="logout-btn">Logout</button>
      </div>
    </header>
    <h2>User Dashboard</h2>
    <form id="ticketForm">
      <input id="title" placeholder="Ticket Title" required />
      <br /><br />
      <textarea id="description" placeholder="Description" required></textarea>
      <br /><br />
      <button>Send Ticket</button>
    </form>

    <ul id="tickets"></ul>

    <script src="/js/auth.js"></script>
    <script src="/js/user.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const user = Auth.requireAuth(); // role optional

        document.getElementById("nav-username").innerText =
          user.unique_name || user.username;

        document.getElementById("nav-role").innerText = user.role;
      });
    </script>
  </body>
</html>
